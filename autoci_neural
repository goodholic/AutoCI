#!/bin/bash
# AutoCI Neural - ì‹ ê²½ë§ ê¸°ë°˜ AI ì‹œìŠ¤í…œ CLI

# ìƒ‰ìƒ ì •ì˜
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
PURPLE='\033[0;35m'
NC='\033[0m' # No Color

# AutoCI ë””ë ‰í† ë¦¬ ì„¤ì •
AUTOCI_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd "$AUTOCI_DIR"

# ê°€ìƒí™˜ê²½ ê²½ë¡œ ì„¤ì •
VENV_PATH=""
if [ -d "neural_venv" ]; then
    VENV_PATH="neural_venv"
elif [ -d "llm_venv_wsl" ]; then
    VENV_PATH="llm_venv_wsl"
elif [ -d "llm_venv" ]; then
    VENV_PATH="llm_venv"
elif [ -d "venv" ]; then
    VENV_PATH="venv"
fi

# ê°€ìƒí™˜ê²½ í™œì„±í™”
if [ -n "$VENV_PATH" ] && [ -f "$VENV_PATH/bin/activate" ]; then
    echo -e "${GREEN}âœ“ ê°€ìƒí™˜ê²½ í™œì„±í™”: $VENV_PATH${NC}"
    source "$VENV_PATH/bin/activate"
else
    echo -e "${YELLOW}âš ï¸  ê°€ìƒí™˜ê²½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‹œìŠ¤í…œ Pythonì„ ì‚¬ìš©í•©ë‹ˆë‹¤.${NC}"
fi

# íŒŒì´ì¬ í™˜ê²½ í™•ì¸
if ! command -v python3 &> /dev/null; then
    echo -e "${RED}âŒ Python3ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.${NC}"
    exit 1
fi

# ë°°ë„ˆ ì¶œë ¥
print_banner() {
    echo -e "${PURPLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                                                               â•‘"
    echo "â•‘      ğŸ§  AutoCI Neural - ChatGPT ìˆ˜ì¤€ì˜ ì‹ ê²½ë§ AI ğŸ§           â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•‘    100% ìˆœìˆ˜ ì‹ ê²½ë§ | 10ì–µ+ íŒŒë¼ë¯¸í„° | ëŒ€ê·œëª¨ í•™ìŠµ           â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
}

# ëª…ë ¹ì–´ ì²˜ë¦¬
case "$1" in
    # ê¸°ë³¸ ì‹¤í–‰ - í†µí•© ëŒ€í™”í˜• ì‹œìŠ¤í…œ
    "")
        print_banner
        echo -e "${CYAN}ğŸš€ ì‹ ê²½ë§ ê¸°ë°˜ ëŒ€í™”í˜• AIë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...${NC}"
        echo -e "${GREEN}âœ¨ ChatGPT ìˆ˜ì¤€ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”${NC}"
        echo -e "${GREEN}ğŸ§  ì‹¤ì‹œê°„ í•™ìŠµ ë° ê°œì„ ${NC}"
        echo -e "${GREEN}ğŸ“Š 1ë¶„ë§ˆë‹¤ ìë™ ëª¨ë‹ˆí„°ë§${NC}"
        echo
        
        if [ -f "integrated_autoci_system.py" ]; then
            python3 integrated_autoci_system.py
        else
            echo -e "${RED}âŒ í†µí•© ì‹œìŠ¤í…œ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
            exit 1
        fi
        ;;
    
    # ì‹ ê²½ë§ ëŒ€í™” ëª¨ë“œ
    chat|c)
        print_banner
        echo -e "${CYAN}ğŸ’¬ ì‹ ê²½ë§ ëŒ€í™” ëª¨ë“œ${NC}"
        if [ -f "run_complete_neural_autoci.py" ]; then
            python3 run_complete_neural_autoci.py
        else
            echo -e "${RED}âŒ ì‹ ê²½ë§ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
            exit 1
        fi
        ;;
    
    # í•™ìŠµ ëª…ë ¹
    train|t)
        print_banner
        echo -e "${GREEN}ğŸ”¥ ëŒ€ê·œëª¨ ì‹ ê²½ë§ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤...${NC}"
        echo -e "${YELLOW}âš¡ ë¶„ì‚° í•™ìŠµ ì‹œìŠ¤í…œ (Multi-GPU ì§€ì›)${NC}"
        
        if [ -f "distributed_training_system.py" ]; then
            python3 distributed_training_system.py
        else
            echo -e "${RED}âŒ ë¶„ì‚° í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
            exit 1
        fi
        ;;
    
    # ë°ì´í„° ìƒì„±
    data|d)
        print_banner
        echo -e "${CYAN}ğŸ“š ëŒ€ê·œëª¨ í•™ìŠµ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤...${NC}"
        echo -e "${YELLOW}ëª©í‘œ: 100,000ê°œ ê³ í’ˆì§ˆ Unity/C# ì˜ˆì œ${NC}"
        
        if [ -f "large_scale_training_pipeline.py" ]; then
            python3 large_scale_training_pipeline.py
        else
            echo -e "${RED}âŒ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
            exit 1
        fi
        ;;
    
    # í…ŒìŠ¤íŠ¸
    test)
        print_banner
        echo -e "${CYAN}ğŸ§ª ì‹ ê²½ë§ ì‹œìŠ¤í…œì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤...${NC}"
        
        if [ -f "test_neural_system.py" ]; then
            python3 test_neural_system.py
        else
            echo -e "${RED}âŒ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
            exit 1
        fi
        ;;
    
    # ëª¨ë‹ˆí„°ë§
    monitor|m)
        case "$2" in
            start)
                echo -e "${GREEN}ğŸ“Š AI í•™ìŠµ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•©ë‹ˆë‹¤...${NC}"
                if [ -f "ai_learning_monitor.py" ]; then
                    python3 ai_learning_monitor.py &
                    echo -e "${CYAN}ğŸŒ ì›¹ ëŒ€ì‹œë³´ë“œ: http://localhost:8888${NC}"
                else
                    echo -e "${RED}âŒ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            web)
                echo -e "${CYAN}ğŸŒ ì›¹ ëŒ€ì‹œë³´ë“œë¥¼ ì—½ë‹ˆë‹¤...${NC}"
                if [ -f "monitoring_dashboard.html" ]; then
                    # WSLì—ì„œ Windows ë¸Œë¼ìš°ì € ì—´ê¸°
                    if command -v cmd.exe &> /dev/null; then
                        cmd.exe /c start http://localhost:8888
                    elif command -v xdg-open &> /dev/null; then
                        xdg-open "http://localhost:8888"
                    else
                        echo "ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8888 ì„ ì—´ì–´ì£¼ì„¸ìš”"
                    fi
                else
                    echo -e "${RED}âŒ ëŒ€ì‹œë³´ë“œ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            *)
                echo -e "${YELLOW}ì‚¬ìš©ë²•: autoci_neural monitor [start|web]${NC}"
                ;;
        esac
        ;;
    
    # ìƒíƒœ í™•ì¸
    status|s)
        print_banner
        echo -e "${CYAN}ğŸ“Š ì‹œìŠ¤í…œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤...${NC}"
        
        if [ -f "integrated_autoci_system.py" ]; then
            python3 -c "
from integrated_autoci_system import IntegratedAutoCI
ai = IntegratedAutoCI()
print(ai.show_status())
"
        else
            echo -e "${RED}âŒ ìƒíƒœ í™•ì¸ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
        fi
        ;;
    
    # 24ì‹œê°„ ì—°ì† ì‹ ê²½ë§ í•™ìŠµ
    learn|l)
        case "$2" in
            start)
                echo -e "${GREEN}ğŸ§  24ì‹œê°„ C# ì‹ ê²½ë§ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤...${NC}"
                if [ -f "start_neural_learning.py" ]; then
                    python3 start_neural_learning.py start
                else
                    echo -e "${RED}âŒ ì‹ ê²½ë§ í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            stop)
                echo -e "${YELLOW}ğŸ›‘ ì‹ ê²½ë§ í•™ìŠµì„ ì¤‘ì§€í•©ë‹ˆë‹¤...${NC}"
                if [ -f "start_neural_learning.py" ]; then
                    python3 start_neural_learning.py stop
                else
                    echo -e "${RED}âŒ ì‹ ê²½ë§ í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            status)
                echo -e "${CYAN}ğŸ“Š ì‹ ê²½ë§ í•™ìŠµ ìƒíƒœ${NC}"
                if [ -f "start_neural_learning.py" ]; then
                    python3 start_neural_learning.py status
                else
                    echo -e "${RED}âŒ ì‹ ê²½ë§ í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            logs)
                echo -e "${CYAN}ğŸ“„ ì‹ ê²½ë§ í•™ìŠµ ë¡œê·¸${NC}"
                if [ -f "start_neural_learning.py" ]; then
                    python3 start_neural_learning.py logs "${3:-50}"
                else
                    echo -e "${RED}âŒ ì‹ ê²½ë§ í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            monitor)
                echo -e "${CYAN}ğŸ” ì‹¤ì‹œê°„ ì‹ ê²½ë§ í•™ìŠµ ëª¨ë‹ˆí„°ë§${NC}"
                if [ -f "start_neural_learning.py" ]; then
                    python3 start_neural_learning.py monitor
                else
                    echo -e "${RED}âŒ ì‹ ê²½ë§ í•™ìŠµ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
                fi
                ;;
            *)
                echo -e "${YELLOW}ì‚¬ìš©ë²•: autoci_neural learn [start|stop|status|logs|monitor]${NC}"
                echo
                echo "  start   - 24ì‹œê°„ ì‹ ê²½ë§ í•™ìŠµ ì‹œì‘"
                echo "  stop    - í•™ìŠµ ì¤‘ì§€"
                echo "  status  - í•™ìŠµ ìƒíƒœ í™•ì¸"
                echo "  logs    - í•™ìŠµ ë¡œê·¸ í™•ì¸ (ê¸°ë³¸ 50ì¤„)"
                echo "  monitor - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§"
                ;;
        esac
        ;;
    
    # í”„ë¡œì íŠ¸ ë¶„ì„
    analyze|a)
        if [ -z "$2" ]; then
            echo -e "${YELLOW}ì‚¬ìš©ë²•: autoci_neural analyze <í”„ë¡œì íŠ¸_ê²½ë¡œ>${NC}"
            exit 1
        fi
        
        echo -e "${CYAN}ğŸ” í”„ë¡œì íŠ¸ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤: $2${NC}"
        if [ -f "integrated_autoci_system.py" ]; then
            python3 -c "
from integrated_autoci_system import IntegratedAutoCI
ai = IntegratedAutoCI()
ai.start()
response = ai.process_input('$2 í”„ë¡œì íŠ¸ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”')
print(response)
"
        else
            echo -e "${RED}âŒ ë¶„ì„ ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
        fi
        ;;
    
    # ì½”ë“œ ê°œì„ 
    improve|i)
        if [ -z "$2" ]; then
            echo -e "${YELLOW}ì‚¬ìš©ë²•: autoci_neural improve <íŒŒì¼_ê²½ë¡œ>${NC}"
            exit 1
        fi
        
        echo -e "${CYAN}ğŸ’¡ ì½”ë“œë¥¼ ê°œì„ í•©ë‹ˆë‹¤: $2${NC}"
        if [ -f "integrated_autoci_system.py" ]; then
            python3 -c "
from integrated_autoci_system import IntegratedAutoCI
ai = IntegratedAutoCI()
ai.start()
response = ai.process_input('$2 íŒŒì¼ì˜ ì½”ë“œë¥¼ ê°œì„ í•´ì£¼ì„¸ìš”')
print(response)
"
        else
            echo -e "${RED}âŒ ê°œì„  ì‹œìŠ¤í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
        fi
        ;;
    
    # ë„ì›€ë§
    help|h|--help)
        print_banner
        echo -e "${GREEN}AutoCI Neural - ChatGPT ìˆ˜ì¤€ì˜ ìˆœìˆ˜ ì‹ ê²½ë§ AI ì‹œìŠ¤í…œ${NC}"
        echo
        echo -e "${CYAN}ê¸°ë³¸ ëª…ë ¹ì–´:${NC}"
        echo "  autoci_neural              - í†µí•© ëŒ€í™”í˜• AI ì‹œì‘ (ê¸°ë³¸)"
        echo "  autoci_neural chat         - ìˆœìˆ˜ ì‹ ê²½ë§ ëŒ€í™” ëª¨ë“œ"
        echo "  autoci_neural status       - ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸"
        echo
        echo -e "${CYAN}í•™ìŠµ ëª…ë ¹ì–´:${NC}"
        echo "  autoci_neural train        - ëŒ€ê·œëª¨ ì‹ ê²½ë§ í•™ìŠµ (ë¶„ì‚°)"
        echo "  autoci_neural data         - í•™ìŠµ ë°ì´í„° ìƒì„± (100K+)"
        echo "  autoci_neural test         - ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸"
        echo
        echo -e "${CYAN}ê³ ê¸‰ ê¸°ëŠ¥:${NC}"
        echo "  autoci_neural monitor start - AI í•™ìŠµ ëª¨ë‹ˆí„°ë§ ì‹œì‘"
        echo "  autoci_neural monitor web   - ì›¹ ëŒ€ì‹œë³´ë“œ ì—´ê¸°"
        echo "  autoci_neural analyze <ê²½ë¡œ> - í”„ë¡œì íŠ¸ ë¶„ì„"
        echo "  autoci_neural improve <íŒŒì¼> - ì½”ë“œ ê°œì„  ì œì•ˆ"
        echo
        echo -e "${CYAN}24ì‹œê°„ ì‹ ê²½ë§ í•™ìŠµ:${NC}"
        echo "  autoci_neural learn start   - 24ì‹œê°„ C# í•™ìŠµ ì‹œì‘ ğŸ”¥"
        echo "  autoci_neural learn stop    - í•™ìŠµ ì¤‘ì§€"
        echo "  autoci_neural learn status  - í•™ìŠµ ìƒíƒœ í™•ì¸"
        echo "  autoci_neural learn logs    - í•™ìŠµ ë¡œê·¸ í™•ì¸"
        echo "  autoci_neural learn monitor - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§"
        echo
        echo -e "${PURPLE}íŠ¹ì§•:${NC}"
        echo "  ğŸ§  100% ìˆœìˆ˜ ì‹ ê²½ë§ (ê·œì¹™ ê¸°ë°˜ ì½”ë“œ ì—†ìŒ)"
        echo "  ğŸ”¥ 10ì–µ+ íŒŒë¼ë¯¸í„° íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸"
        echo "  ğŸ“Š ëŒ€ê·œëª¨ í•™ìŠµ ë°ì´í„° (100,000+ ì˜ˆì œ)"
        echo "  âš¡ ë¶„ì‚° í•™ìŠµ ì‹œìŠ¤í…œ (Multi-GPU)"
        echo "  ğŸ¯ Unity/C# ì „ë¬¸ íŠ¹í™”"
        echo "  ğŸ’¬ ChatGPT ìˆ˜ì¤€ ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”"
        echo "  ğŸ”„ ì‹¤ì‹œê°„ í•™ìŠµ ë° ê°œì„ "
        echo
        echo -e "${YELLOW}ì˜ˆì‹œ:${NC}"
        echo "  autoci_neural                    # ëŒ€í™”í˜• AI ì‹œì‘"
        echo "  autoci_neural train              # ì‹ ê²½ë§ í•™ìŠµ"
        echo "  autoci_neural monitor start      # ëª¨ë‹ˆí„°ë§ ì‹œì‘"
        echo "  autoci_neural analyze ./myproject # í”„ë¡œì íŠ¸ ë¶„ì„"
        ;;
    
    *)
        echo -e "${RED}âŒ ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹ì–´: $1${NC}"
        echo -e "${YELLOW}ë„ì›€ë§ì„ ë³´ë ¤ë©´ 'autoci_neural help'ë¥¼ ì…ë ¥í•˜ì„¸ìš”.${NC}"
        exit 1
        ;;
esac