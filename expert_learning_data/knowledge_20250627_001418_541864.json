{
  "source": "github_patterns",
  "url": "https://github.com/eventflow/EventFlow",
  "type": "project_documentation",
  "content": "# EventFlow\n\n![EventFlow logo](https://raw.githubusercontent.com/eventflow/EventFlow/develop-v1/icon-128.png)\n\n![NuGet downloads](https://img.shields.io/nuget/dt/EventFlow)\n\n```\n$ dotnet add package EventFlow\n```\n\nEventFlow is a basic CQRS+ES framework designed to be easy to use.\n\nHave a look at our [getting started guide](https://geteventflow.net/getting-started/),\nthe [doâ€™s and donâ€™ts](https://geteventflow.net/additional/dos-and-donts/) and the\n[FAQ](https://geteventflow.net/additional/faq/).\n\nAlternatively, join our [Discord](https://discord.gg/QfgNPs5WxR) server to engage with the community. Its hopefully getting a reboot to kickstart the upcoming release of v1.\n\n## Features\n\n* **Easy to use**: Designed with sensible defaults and implementations that make it\n  easy to create an example application\n* **Highly configurable and extendable**: EventFlow uses interfaces for every part of\n  its core, making it easy to replace or extend existing features with custom\n  implementation\n* **No use of threads or background workers**\n* **MIT licensed** Easy to understand and use license for enterprise\n\n## Versions\n\nDevelopment of version 1.0 has started and is mainly braking changes regarding changes\nrelated to replacing EventFlow types with that of Microsoft extension abstractions,\nmainly `IServiceProvider` and `ILogger<>`.\n\nThe following list key characteristics of each version as well as its related branches\n(not properly configured yet).\n\n* `1.x`\n\n  Represents the next iteration of EventFlow that aligns EventFlow with the standard\n  packages for .NET. Releases here will only support .NET Standard, .NET Core\n  and .NET versions 6+ going forward.\n\n  - Released\n  - Still development\n  - Not all projects migrated yet\n  \n  Read the [migration guide](https://geteventflow.net/migrations/v0-to-v1/) to view the full list of breaking\n  changes as well as recommendations on how to migrate.\n\n  ### Documentation\n  Version 1.x documentation has been pulled into this repository in order to have\n  the code and documentation closer together and have the documentation\n  updated in the same pull-requests as any code changes. The compiled version of the\n  documentation is available at https://geteventflow.net/.\n\n  ### NuGet package status\n\n  - ðŸŸ¢ ported\n  - ðŸ’š newly added to 1.0\n  - ðŸŸ  not yet ported to 1.0\n  - ðŸ’€ for packages that are removed as part of 1.0 (see the [migration guide](https://geteventflow.net/migrations/v0-to-v1/) for details)\n\n  Projects\n    - ðŸŸ¢ `EventFlow`\n    - ðŸŸ  `EventFlow.AspNetCore`\n    - ðŸ’€ `EventFlow.Autofac`\n    - ðŸ’€ `EventFlow.DependencyInjection`\n    - ðŸŸ  `EventFlow.Elasticsearch`\n    - ðŸŸ¢ `EventFlow.EntityFramework`\n    - ðŸŸ  `EventFlow.EventStores.EventStore`\n    - ðŸŸ¢ `EventFlow.Hangfire`\n    - ðŸŸ¢ `EventFlow.MongoDB`\n    - ðŸŸ¢ `EventFlow.MsSql`\n    - ðŸ’€ `EventFlow.Owin`\n    - ðŸŸ¢ `EventFlow.PostgreSql`\n    - ðŸŸ  `EventFlow.Redis`\n    - ðŸŸ  `EventFlow.RabbitMQ`\n    - ðŸŸ¢ `EventFlow.Sql`\n    - ðŸŸ¢ `EventFlow.SQLite`\n    - ðŸŸ¢ `EventFlow.TestHelpers`\n\n  ### Branches\n  - `develop-v1`: Development branch, pull requests should be done here\n  - `release-v1`: Release branch, merge commits are done to this branch from\n    `develop-v1` to create releases. Typically each commit represents a release\n\n* `0.x` (legacy)\n\n  The current stable version of EventFlow and has been the version of EventFlow\n  for almost six years. 0.x versions have .NET Framework support and limited\n  support to the Microsoft extension packages through extra NuGet packages.\n\n  Feature and bug fix releases will still be done while there's interest in\n  the community.\n\n  ### Branches\n  - `develop-v0`: Development branch, pull requests should be done here\n  - `release-v0`: Release branch, merge commits are done to this branch from\n    `develop-v0` to create releases. Typically each commit represents a release\n\n  ### Documentation\n  Version 0.x documentation is (although a bit outdated) is live at\n  https://docs.geteventflow.net/.\n\n\n## Talks directly related to EventFlow\n\n- [GOTO Aarhus 2022](https://github.com/rasmus/presentation-goto-2022) by [rasmus](https://github.com/rasmus)\n  Practical event sourcing using EventFlow\n\n## Examples\n\n* **[Complete](#complete-example):** Shows a complete example on how to use\n  EventFlow with in-memory event store and read models in a relatively few lines\n  of code\n* **Shipping:** To get a more complete example of how EventFlow _could_ be used,\n  have a look at the shipping example found here in the code base. The example\n  is based on the shipping example from the book \"Domain-Driven Design -\n  Tackling Complexity in the Heart of Software\" by Eric Evans. Its\n  _in-progress_, but should provide inspiration on how to use EventFlow on a\n  larger scale. If you have ideas and/or comments, create a pull request or\n  an issue\n  \n### External Examples\n\nList of examples create by different community members. Note that many of these\nexamples will be using EventFlow 0.x.\n\n*Create a pull request to get your exampled linked from here.*\n\n * **[Racetimes:](https://github.com/dennisfabri/Eventflow.Example.Racetimes)**\n   Shows some features of EventFlow that are not covered in the \n   [complete example](#complete-example). It features entities, a read model for \n   an entity, delete on read models, specifications and snapshots.\n\n   * **[Racetimes for Azure Functions:](https://github.com/craignicol/Eventflow.Example.Racetimes)**\n     Extends the above example to support the HTTP access via Azure Functions\n     \n   * **[Racetimes for Azure Functions and Event Grid:](https://github.com/craignicol/Eventflow.Example.Racetimes/tree/feature/event-grid-as-extension)**\n     Further extends the Azure Functions Example to publish to Event Grid, following the RabbitMQ pattern\n\n * **[.NET Core:](https://github.com/johnny-chan/EventFlowDemo)**\n\tA Web API running .NET Core 2.2 using the event flow. It uses the pre-defined \n\tcommand/entities/events from the [complete example](#complete-example). There are endpoints to \n\tcreate a new example event, getting a data model and to replay all data models.\n\t\n* **[ElasticSearch/.NET Core:](https://github.com/DureSameen/EventFlowWithElasticSearch)**\n\tIt is configured with EventFlow, ElasticSearch, EventStore, and RabbitMq. See \"withRabbitMq\" branch for #384.\n\n * **[Vehicle Tracking:](https://github.com/MongkonEiadon/VehicleTracker)**\n\tA Microservice on .NET Core 2.2 with docker based, you can up the service with docker-compose, this project using various\n  tools to up the services aka. Linux Docker based on .NET Core, RabbitMq, EntityFramework with SQL Server and using EventFlow following CQRS-ES architecture\n  and all microservice can access through ApiGateway which using Ocelot\n\n  * **[RestAirline:](https://github.com/twzhangyang/RestAirline)**\n\tA classic DDD with CQRS-ES, Hypermedia API project based on EventFlow. It's targeted to ASP.NET Core 2.2 and can be deployed to docker and k8s.\n\t\n* **[Full Example:](https://github.com/OKTAYKIR/EventFlow.Example)**\n\tA console application on .NET Core 2.2. You can up the services using [docker-compose file](https://github.com/OKTAYKIR/EventFlow.Example/blob/master/build/docker-compose.yml). Docker-compose file include EventStore, RabbitMq, MongoDb, and PostgreSQL. It include following EventFlow concepts:\n\t* Aggregates\n\t* Command bus and commands\n\t* Synchronous subscriber\n\t* Event store ([GES](https://eventstore.com/))\n\t* In-memory read model.\n\t* Snapshots ([MongoDb](https://www.mongodb.com/))\n\t* Sagas\n\t* Event publising (In-memory, [RabbitMq](https://www.rabbitmq.com/))\n\t* Metadata\n\t* Command bus decorator, custom value object, custom execution result, ...\n\t\n### Overview\n\nHere is a list of the EventFlow concepts. Use the links to navigate\nto the documentation.\n\n* [**Aggregates:**](https://geteventflow.net/basics/aggregates/)\n  Domains object that guarantees the consistency of changes being made within\n  each aggregate\n* [**Command bus and commands:**](https://geteventflow.net/basics/commands/)\n  Entry point for all command/operation execution.\n* [**Event store:**](https://geteventflow.net/integration/event-stores/)\n  Storage of the event stream for aggregates. Currently there is support for\n  these storage types.\n  * In-memory - only for test\n  * Files - only for test\n  * Microsoft SQL Server\n  * Entity Framework Core\n  * SQLite\n  * PostgreSQL\n  * EventStore - [home page](https://eventstore.org/)\n* [**Subscribers:**](https://geteventflow.net/basics/subscribers/)\n  Listeners that act on specific domain events. Useful if an specific action\n  needs to be triggered after a domain event has been committed.\n* [**Read models:**](https://geteventflow.net/integration/read-stores/)\n  Denormalized representation of aggregate events optimized for reading fast.\n  Currently there is support for these read model storage types.\n  For the SQL storage types the queries are being generated automatically with quoted columns and table names.\n  * Elasticsearch\n  * In-memory - only for test\n  * Microsoft SQL Server\n  * Entity Framework Core\n  * SQLite\n  * PostgreSQL\n* [**Snapshots:**](https://geteventflow.net/additional/snapshots/)\n  Instead of reading the entire event stream every single time, a snapshot can\n  be created every so often that contains the aggregate state. EventFlow\n  supports upgrading existing snapshots, which is useful for long-lived\n  aggregates. Snapshots in EventFlow are opt-in and EventFlow has support for\n  * In-memory - only for test\n  * Microsoft SQL Server\n  * Entity Framework Core\n  * SQLite\n  * PostgreSQL\n* [**Sagas:**](https://geteventflow.net/basics/sagas/)\n  Also known as _process managers_, coordinates and routes messages between\n  bounded contexts and aggregates\n* [**Queries:**](https://geteventflow.net/basics/queries/)\n  Value objects that represent a query without specifying how its executed,\n  that is let to a query handler\n* [**Jobs:**](https://geteventflow.net/basics/jobs/) Perform scheduled tasks at\n  a later time, e.g. publish a command. EventFlow provides support for these\n  job schedulers\n  * Hangfire - [home page](https://hangfire.io/)\n* [**Event upgrade:**](https://geteventflow.net/basics/event-upgrade/)\n  As events committed to the event store is never changed, EventFlow uses the\n  concept of event upgraders to deprecate events and replace them with new\n  during aggregate load.\n* **Event publishing:** Sometimes you want other applications or services to\n  consume and act on domains. For this EventFlow supports event publishing.\n  * RabbitMQ\n* [**Metadata:**](https://geteventflow.net/basics/metadata/)\n  Additional information for each aggregate event, e.g. the IP of\n  the user behind the event being emitted. EventFlow ships with\n  several providers ready to use used.\n* [**Value objects:**](https://geteventflow.net/additional/value-objects/)\n  Data containing classes used to validate and hold domain data, e.g. a\n  username or e-mail.\n\n## Complete example\nHere's a complete example on how to use the default in-memory event store\nalong with an in-memory read model.\n\nThe example consists of the following classes, each shown below\n\n- `ExampleAggregate`: The aggregate root\n- `ExampleId`: Value object representing the identity of the aggregate root\n- `ExampleEvent`: Event emitted by the aggregate root\n- `ExampleCommand`: Value object defining a command that can be published to the\n  aggregate root\n- `ExampleCommandHandler`: Command handler which EventFlow resolves using its IoC\n  container and defines how the command specific is applied to the aggregate root\n- `ExampleReadModel`: In-memory read model providing easy access to the current\n  state\n\n**Note:** This example is part of the EventFlow test suite, so checkout the\ncode and give it a go.\n\n```csharp\n[Test]\npublic async Task Example()\n{\n  // We wire up EventFlow with all of our classes. Instead of adding events,\n  // commands, etc. explicitly, we could have used the the simpler\n  // AddDefaults(Assembly) instead.\n  var serviceCollection = new ServiceCollection()\n    .AddLogging()\n    .AddEventFlow(o => o\n      .AddEvents(typeof(ExampleEvent))\n      .AddCommands(typeof(ExampleCommand))\n      .AddCommandHandlers(typeof(ExampleCommandHandler))\n      .UseInMemoryReadStoreFor<ExampleReadModel>());\n\n  using (var serviceProvider = serviceCollection.BuildServiceProvider())\n  {\n    // Create a new identity for our aggregate root\n    var exampleId = ExampleId.New;\n\n    // Resolve the command bus and use it to publish a command\n    var commandBus = serviceProvider.GetRequiredService<ICommandBus>();\n    await commandBus.PublishAsync(\n      new ExampleCommand(exampleId, 42), CancellationToken.None);\n\n    // Resolve the query handler and use the built-in query for fetching\n    // read models by identity to get our read model representing the\n    // state of our aggregate root\n    var queryProcessor = serviceProvider.GetRequiredService<IQueryProcessor>();\n    var exampleReadModel = await queryProcessor.ProcessAsync(\n      new ReadModelByIdQuery<ExampleReadModel>(exampleId), CancellationToken.None);\n\n    // Verify that the read model has the expected magic number\n    exampleReadModel.MagicNumber.Should().Be(42);\n  }\n}\n```\n\n```csharp\n// The aggregate root\npublic class ExampleAggregate : AggregateRoot<ExampleAggregate, ExampleId>,\n  IEmit<ExampleEvent>\n{\n  private int? _magicNumber;\n\n  public ExampleAggregate(ExampleId id) : base(id) { }\n\n  // Method invoked by our command\n  public void SetMagicNumber(int magicNumber)\n  {\n    if (_magicNumber.HasValue)\n      throw DomainError.With(\"Magic number already set\");\n\n    Emit(new ExampleEvent(magicNumber));\n  }\n\n  // We apply the event as part of the event sourcing system. EventFlow\n  // provides several different methods for doing this, e.g. state objects,\n  // the Apply method is merely the simplest\n  public void Apply(ExampleEvent aggregateEvent)\n  {\n    _magicNumber = aggregateEvent.MagicNumber;\n  }\n}\n```\n\n```csharp\n// Represents the aggregate identity (ID)\npublic class ExampleId : Identity<ExampleId>\n{\n  public ExampleId(string value) : base(value) { }\n}\n```\n\n```csharp\n// A basic event containing some information\npublic class ExampleEvent : AggregateEvent<ExampleAggregate, ExampleId>\n{\n  public ExampleEvent(int magicNumber)\n  {\n      MagicNumber = magicNumber;\n  }\n\n  public int MagicNumber { get; }\n}\n```\n\n```csharp\n// Command for update magic number\npublic class ExampleCommand : Command<ExampleAggregate, ExampleId>\n{\n  public ExampleCommand(\n    ExampleId aggregateId,\n    int magicNumber)\n    : base(aggregateId)\n  {\n    MagicNumber = magicNumber;\n  }\n\n  public int MagicNumber { get; }\n}\n```\n\n```csharp\n// Command handler for our command\npublic class ExampleCommandHandler\n  : CommandHandler<ExampleAggregate, ExampleId, ExampleCommand>\n{\n  public override Task ExecuteAsync(\n    ExampleAggregate aggregate,\n    ExampleCommand command,\n    CancellationToken cancellationToken)\n  {\n    aggregate.SetMagicNumber(command.MagicNumber);\n    return Task.CompletedTask;;\n  }\n}\n```\n\n```csharp\n// Read model for our aggregate\npublic class ExampleReadModel : IReadModel,\n  IAmReadModelFor<ExampleAggregate, ExampleId, ExampleEvent>\n{\n  public int MagicNumber { get; private set; }\n\n  public Task ApplyAsync(\n    IReadModelContext context,\n    IDomainEvent<ExampleAggregate, ExampleId, ExampleEvent> domainEvent,\n    CancellationToken _cancellationToken\n  {\n    MagicNumber = domainEvent.AggregateEvent.MagicNumber;\n    return Task.CompletedTask;\n  }\n}\n```\n\n\n## State of EventFlow\n\nEventFlow is still under development, especially the parts regarding\nhow read models are re-populated.\n\nEventFlow  _is_ currently used in production environments and performs very well,\nbut it needs to mature before key APIs are stable.\n\nEventFlow is greatly opinionated, but it's possible to create new implementations\nfor almost every part of EventFlow by registering a different implementation of\nan interface.\n\n## Useful articles related to EventFlow and DDD\n\nMany of the technical design decisions in EventFlow is based on articles. This\nsection lists some of them. If you have a link with a relevant article, please\nshare it by creating an issue with the link.\n\n* **Domain-Driven Design**\n  * [Domain-Driven Design Reference](https://domainlanguage.com/ddd/reference/)\n    by Eric Evans\n  * [DDD Decoded - Bounded Contexts Explained](https://blog.sapiensworks.com/post/2016/08/12/DDD-Bounded-Contexts-Explained)\n  * [Going \"Events-First\" for Microservices with Event Storming and DDD](http://www.russmiles.com/essais/going-events-first-for-microservices-with-event-storming-and-ddd)\n* **General CQRS+ES**\n  * [CQRS Journey by Microsoft](https://msdn.microsoft.com/en-us/library/jj554200.aspx)\n    published by Microsoft\n  * [An In-Depth Look At CQRS](https://blog.sapiensworks.com/post/2015/09/01/In-Depth-CQRS)\n    by Mike Mogosanu\n  * [CQRS, Task Based UIs, Event Sourcing agh!](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)\n    by Greg Young\n  * [Busting some CQRS myths](https://lostechies.com/jimmybogard/2012/08/22/busting-some-cqrs-myths/)\n    by Jimmy Bogard\n  * [CQRS applied](https://lostechies.com/gabrielschenker/2015/04/12/cqrs-applied/)\n    by Gabriel Schenker\n  * [DDD Decoded - Entities and Value Objects Explained](https://blog.sapiensworks.com/post/2016/07/29/DDD-Entities-Value-Objects-Explained)\n* **Eventual consistency**\n  * [How To Ensure Idempotency In An Eventual Consistent DDD/CQRS Application](https://blog.sapiensworks.com/post/2015/08/26/How-To-Ensure-Idempotency)\n   by Mike Mogosanu\n  * [DDD Decoded - Don't Fear Eventual Consistency](https://blog.sapiensworks.com/post/2016/07/23/DDD-Eventual-Consistency)\n* **Why _not_ to implement \"unit of work\" in DDD**\n  * [Unit Of Work is the new Singleton](https://blog.sapiensworks.com/post/2014/06/04/Unit-Of-Work-is-the-new-Singleton.aspx)\n    by Mike Mogosanu\n  * [The Unit of Work and Transactions In Domain-Driven Design](https://blog.sapiensworks.com/post/2015/09/02/DDD-and-UoW)\n    by Mike Mogosanu\n\n\n### Integration tests\n\nEventFlow has several tests that verify that its ability to use the systems it\nintegrates with correctly.\n\n * [Elasticsearch](https://www.elastic.co/)\n * [EventStore](https://geteventstore.com/)\n * [RabbitMQ](https://www.rabbitmq.com/)\n * Microsoft SQL Server\n * PostgreSQL\n\nTo setup a local test environment run the following commands in the checkout\ndirectory of EventFlow.\n\n```\ndocker-compose pull\ndocker-compose up\n```\n\nAlternatively, you can skip the NUnit tests marked with the `integration`\ncategory.\n\n## Thanks\n\n\n![JetBrains logo](https://raw.githubusercontent.com/eventflow/EventFlow/develop-v1/Resources/jetbrains-128x128.png)\n\n* [Contributors](https://github.com/eventflow/EventFlow/graphs/contributors)\n* [JetBrains](https://www.jetbrains.com/resharper/): OSS licenses\n* [olholm](https://github.com/olholm): Current logo\n* [iconmonstr](https://iconmonstr.com/network-6-icon/): First logo\n* [JC008](https://github.com/JC008): License for Navicat Essentials for SQLite\n\n## License\n\nEventFlow was originally developed <u>in my spare time</u> while I worked at both\n<a href=\"https://www.ebay.com/\">eBay (2015 to 2021)</a> and\n<a href=\"https://schibsted.com/\">Schibsted (2021 and onward)</a>.\n\n```\nThe MIT License (MIT)\n\nCopyright (c) 2015-2025 Rasmus Mikkelsen\nhttps://github.com/eventflow/EventFlow\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n```\n\n\n",
  "stars": 2470,
  "timestamp": "2025-06-27T00:14:18.541854",
  "category": "advanced_patterns"
}